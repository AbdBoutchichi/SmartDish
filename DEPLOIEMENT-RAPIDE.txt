# üöÄ D√âPLOIEMENT MANUEL - GUIDE RAPIDE

## ‚ö° M√©thode Rapide (3 √©tapes)

### 1Ô∏è‚É£ Configurer kubeconfig (UNE SEULE FOIS)

```powershell
.\setup-kubeconfig.ps1
```

Quand demand√©, coller le contenu du secret `OCI_KUBECONFIG` depuis GitHub.

### 2Ô∏è‚É£ D√©ployer

```powershell
.\deploy-manual.ps1 -Environment integration -ImageTag latest
```

### 3Ô∏è‚É£ V√©rifier

```powershell
kubectl get pods -n integration
kubectl logs -n integration -l app=univ.soa --tail=100 -f
```

---

## üîë Secrets n√©cessaires

Le script `deploy-manual.ps1` vous demandera (si les secrets n'existent pas d√©j√†) :

- **OCI_TENANCY_NAMESPACE** (ex: axfuowvuxal7)
- **OCI_USERNAME** (ex: votre-email@gmail.com)
- **OCI_AUTH_TOKEN** (token g√©n√©r√© dans OCI Console)
- **MYSQL_HOST** (adresse du serveur MySQL)
- **MYSQL_USER** (utilisateur MySQL)
- **MYSQL_PASSWORD** (mot de passe MySQL)
- **MYSQL_ROOT_PASSWORD** (mot de passe root MySQL)

Vous pouvez les trouver dans :
**GitHub > Repository > Settings > Secrets and variables > Actions**

---

## üìã Commandes utiles

### Voir l'√©tat
```powershell
kubectl get all -n integration
```

### Voir les logs en temps r√©el
```powershell
kubectl logs -n integration -l app=univ.soa -f
```

### Red√©marrer les pods
```powershell
kubectl rollout restart deployment/univ.soa -n integration
```

### Voir les √©v√©nements (pour debug)
```powershell
kubectl get events -n integration --sort-by='.lastTimestamp'
```

### Mettre √† jour l'image
```powershell
kubectl set image deployment/univ.soa univ.soa=cdg.ocir.io/axfuowvuxal7/smartdish/univ.soa:nouveau-tag -n integration
```

---

## üêõ Probl√®mes fr√©quents

### "You must be logged in to the server"
‚û°Ô∏è Ex√©cuter `.\setup-kubeconfig.ps1` avec le secret OCI_KUBECONFIG

### "ImagePullBackOff"
‚û°Ô∏è V√©rifier le secret OCIR :
```powershell
kubectl describe secret ocir-secret -n integration
```

### "CrashLoopBackOff"
‚û°Ô∏è Voir les logs :
```powershell
kubectl logs -n integration -l app=univ.soa --previous
```

### Le script demande les secrets √† chaque fois
‚û°Ô∏è Normal si les secrets n'existent pas dans le cluster. Une fois cr√©√©s, le script les r√©utilise.

---

## üìö Documentation compl√®te

Pour plus de d√©tails, voir le guide complet que je vous ai affich√© pr√©c√©demment.

---

## ‚úÖ Checklist avant d√©ploiement

- [ ] kubectl install√© et accessible
- [ ] kubeconfig configur√© (via setup-kubeconfig.ps1)
- [ ] Connexion au cluster r√©ussie (kubectl get nodes)
- [ ] Image Docker disponible dans OCIR
- [ ] Secrets disponibles (ou les avoir sous la main)

Une fois tout coch√©, lancer : `.\deploy-manual.ps1`

